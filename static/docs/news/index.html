<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog • torch</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Changelog"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-9ZJSKW3L0N"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9ZJSKW3L0N');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">torch</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.13.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/installation.html">Installation</a>
    <h6 class="dropdown-header" data-toc-skip>Tensors</h6>
    <a class="dropdown-item" href="../articles/tensor-creation.html">Creating tensors</a>
    <a class="dropdown-item" href="../articles/indexing.html">Indexing</a>
    <a class="dropdown-item" href="../articles/tensor/index.html">Tensor class</a>
    <a class="dropdown-item" href="../articles/serialization.html">Serialization</a>
    <h6 class="dropdown-header" data-toc-skip>Datasets</h6>
    <a class="dropdown-item" href="../articles/loading-data.html">Loading Data</a>
    <h6 class="dropdown-header" data-toc-skip>Autograd</h6>
    <a class="dropdown-item" href="../articles/using-autograd.html">Using autograd</a>
    <a class="dropdown-item" href="../articles/extending-autograd.html">Extending autograd</a>
    <a class="dropdown-item" href="../articles/python-to-r.html">Python models</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/examples/basic-autograd.html">basic-autograd</a>
    <a class="dropdown-item" href="../articles/examples/basic-nn-module.html">basic-nn-module</a>
    <a class="dropdown-item" href="../articles/examples/dataset.html">dataset</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-advanced">Advanced</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-advanced">
    <a class="dropdown-item" href="../articles/memory-management.html">Memory management</a>
    <a class="dropdown-item" href="../articles/modifying-source-code.html">Building locally</a>
    <a class="dropdown-item" href="../articles/amp.html">Automatic Mixed Precision</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mlverse/torch/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-news">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Changelog</h1>
      <small>Source: <a href="https://github.com/mlverse/torch/blob/HEAD/NEWS.md" class="external-link"><code>NEWS.md</code></a></small>
    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.13.0" id="torch-0130">torch 0.13.0<a class="anchor" aria-label="anchor" href="#torch-0130"></a></h2><p class="text-muted">CRAN release: 2024-05-21</p>
<div class="section level3">
<h3 id="breaking-changes-0-13-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-13-0"></a></h3>
<ul><li>lantern is now distributed over a different URL (<a href="https://torch-cdn.mlverse.org" class="external-link uri">https://torch-cdn.mlverse.org</a>). For most users this shouldn’t have any effect, unless you need special authorization to access some URL’s. (<a href="https://github.com/mlverse/torch/issues/1162" class="external-link">#1162</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-13-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-13-0"></a></h3>
<ul><li>Added support for a private <code>$finalize_deep_clone()</code> method for <code>nn_module</code> which allows to run some code after cloning a module.</li>
<li>A <code>compare_proxy</code> method for the <code>torch_tensor</code> type was added it allows to compare torch tensors using <code><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">testthat::expect_equal()</a></code>.</li>
<li>Converting torch tensor to R array works when tensor has ‘cuda’ device (<a href="https://github.com/mlverse/torch/issues/1130" class="external-link">#1130</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-13-0">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-13-0"></a></h3>
<ul><li>Fix a bug on using input projection initialization bias in <code>nnf_multi_head_attention_forward</code> (<a href="https://github.com/mlverse/torch/issues/1154" class="external-link">#1154</a> <a href="https://github.com/cregouby" class="external-link">@cregouby</a>)</li>
<li>Bugfix: calling <code>$detach()</code> on a tensor now preserves attributes (<a href="https://github.com/mlverse/torch/issues/1136" class="external-link">#1136</a>)</li>
<li>Make sure deep cloning of tensor and nn_module preserves class attributes and the requires_grad field. (<a href="https://github.com/mlverse/torch/issues/1129" class="external-link">#1129</a>)</li>
<li>Fixed that parameters and buffers of children of nn_modules were not cloned</li>
<li>Cloned objects no longer reference the object from which they were cloned</li>
<li>Fixed bug where nn_module’s patched clone method was invalid after a call to the internal <code>create_nn_module_callable()</code>
</li>
<li>Printing of <code>grad_fn</code> now appends a new line at the end.</li>
<li>Make sure deep cloning preserve state dict attributes. (<a href="https://github.com/mlverse/torch/issues/1129" class="external-link">#1129</a>)</li>
<li>Added separate setter and unsetter for the autocast context instead of only allowing <code><a href="../reference/local_autocast.html">local_autocast()</a></code>. (<a href="https://github.com/mlverse/torch/issues/1142" class="external-link">#1142</a>)</li>
<li>Fixed a bug in <code><a href="../reference/torch_arange.html">torch_arange()</a></code> causing it to return 1:(n-1) values when specific request <code>dtype = torch_int64()</code> (<a href="https://github.com/mlverse/torch/issues/1160" class="external-link">#1160</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.12.0" id="torch-0120">torch 0.12.0<a class="anchor" aria-label="anchor" href="#torch-0120"></a></h2><p class="text-muted">CRAN release: 2023-12-15</p>
<div class="section level3">
<h3 id="breaking-changes-0-12-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-12-0"></a></h3>
<ul><li>New <code>torch_save</code> serialization format. It’s ~10x faster and since it’s based on safetensors, files can be read with any safetensors implementation. (<a href="https://github.com/mlverse/torch/issues/1071" class="external-link">#1071</a>)</li>
<li>Updated to LibTorch 2.0.1. (<a href="https://github.com/mlverse/torch/issues/1085" class="external-link">#1085</a>)</li>
<li>
<code>torch_load</code> no longer supports <code>device=NULL</code> to load weights in the same device they were saved. (<a href="https://github.com/mlverse/torch/issues/1085" class="external-link">#1085</a>)</li>
<li>Lantern binaries and torch pre-built binaries are now built on Ubuntu 20.04. (<a href="https://github.com/mlverse/torch/issues/1124" class="external-link">#1124</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-12-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-12-0"></a></h3>
<ul><li>Added support for CUDA 11.8. (<a href="https://github.com/mlverse/torch/issues/1089" class="external-link">#1089</a>)</li>
<li>Added support for iterable datasets. (<a href="https://github.com/mlverse/torch/issues/1095" class="external-link">#1095</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-12-0">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-12-0"></a></h3>
<ul><li>fix printer of torch device (add new line at the end)</li>
<li>
<code>as.array</code> now moves tensors to the cpu before copying data into R. (<a href="https://github.com/mlverse/torch/issues/1080" class="external-link">#1080</a>)</li>
<li>Fixed segfault caused by comparing a <code>dtype</code> with a <code>NULL</code>. (<a href="https://github.com/mlverse/torch/issues/1090" class="external-link">#1090</a>)</li>
<li>Fixed incorrect naming of complex data type names, such as <code>torch_cfloat64</code>. (<a href="https://github.com/mlverse/torch/issues/1091" class="external-link">#1091</a>)</li>
<li>Fixed name of the <code>out_features</code> attribute in the <code>nn_linear</code> module. (<a href="https://github.com/mlverse/torch/issues/1097" class="external-link">#1097</a>)</li>
<li>Fixed issues when loading the state dict of optimizers and learning rate schedulers. (<a href="https://github.com/mlverse/torch/issues/1100" class="external-link">#1100</a>)</li>
<li>Fixed bug when cloning <code>nn_module</code>s with empty state dicts. (<a href="https://github.com/mlverse/torch/issues/1108" class="external-link">#1108</a>)</li>
<li>
<code>distr_multivariate_normal</code> now correctly handles precision matrix’s. (<a href="https://github.com/mlverse/torch/issues/1110" class="external-link">#1110</a>)</li>
<li>Moved <code>length.torch_tensor</code> implementation to R7 to avoid problems when a torch dataset has the <code>torch_tensor</code> class. (<a href="https://github.com/mlverse/torch/issues/1111" class="external-link">#1111</a>)</li>
<li>Fixed problem when deep cloning a <code>nn_module</code>. (<a href="https://github.com/mlverse/torch/issues/1123" class="external-link">#1123</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.11.0" id="torch-0110">torch 0.11.0<a class="anchor" aria-label="anchor" href="#torch-0110"></a></h2><p class="text-muted">CRAN release: 2023-06-06</p>
<div class="section level3">
<h3 id="breaking-changes-0-11-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-11-0"></a></h3>
<ul><li>
<code><a href="../reference/load_state_dict.html">load_state_dict()</a></code> for optimizers now default to cloning the tensors in the state dict, so they don’t keep references to objects in the dict. (<a href="https://github.com/mlverse/torch/issues/1041" class="external-link">#1041</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-11-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-11-0"></a></h3>
<ul><li>Added <code>nn_utils_weight_norm</code> (<a href="https://github.com/mlverse/torch/issues/1025" class="external-link">#1025</a>)</li>
<li>Added support for reading from ordered state dicts serialized with PyTorch. (<a href="https://github.com/mlverse/torch/issues/1031" class="external-link">#1031</a>)</li>
<li>Added <code>jit_ops</code> allowing to access JIT operators. (<a href="https://github.com/mlverse/torch/issues/1023" class="external-link">#1023</a>)</li>
<li>Added <code>with_device</code> and <code>local_device</code> to allow temporarily modify the default device tensors get initialized. (<a href="https://github.com/mlverse/torch/issues/1034" class="external-link">#1034</a>)</li>
<li>
<code><a href="../reference/nnf_gelu.html">nnf_gelu()</a></code> and <code><a href="../reference/nn_gelu.html">nn_gelu()</a></code> gained the <code>approximate</code> argument. (<a href="https://github.com/mlverse/torch/issues/1043" class="external-link">#1043</a>)</li>
<li>Implemented <code>!=</code> for torch devices. (<a href="https://github.com/mlverse/torch/issues/1042" class="external-link">#1042</a>)</li>
<li>Allows setting the dtype with a string. (<a href="https://github.com/mlverse/torch/issues/1045" class="external-link">#1045</a>)</li>
<li>You can now create a named list of modules using <code><a href="../reference/nn_module_dict.html">nn_module_dict()</a></code>. (<a href="https://github.com/mlverse/torch/issues/1046" class="external-link">#1046</a>)</li>
<li>Faster <code><a href="../reference/load_state_dict.html">load_state_dict()</a></code>, also using less memory. It’ possible to use the legacy implementation if required, see PR. (<a href="https://github.com/mlverse/torch/issues/1051" class="external-link">#1051</a>)</li>
<li>Export helpers for handling RNG state, and temprarily modifying it. (<a href="https://github.com/mlverse/torch/issues/1057" class="external-link">#1057</a>)</li>
<li>Added support for converting half tensors into R with <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric()</a></code>. (<a href="https://github.com/mlverse/torch/issues/1056" class="external-link">#1056</a>)</li>
<li>Added new <code><a href="../reference/torch_tensor_from_buffer.html">torch_tensor_from_buffer()</a></code> and <code><a href="../reference/torch_tensor_from_buffer.html">buffer_from_torch_tensor()</a></code> that allow low level creation of torch tensors. (<a href="https://github.com/mlverse/torch/issues/1061" class="external-link">#1061</a>, <a href="https://github.com/mlverse/torch/issues/1062" class="external-link">#1062</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="documentation-0-11-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-0-11-0"></a></h3>
<ul><li>Improved documentation for LBFGS optimizer. (<a href="https://github.com/mlverse/torch/issues/1035" class="external-link">#1035</a>)</li>
<li>Added a message asking the user to restart the session after a manual installation with <code><a href="../reference/install_torch.html">install_torch()</a></code>. (<a href="https://github.com/mlverse/torch/issues/1055" class="external-link">#1055</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-11-0">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-11-0"></a></h3>
<ul><li>Fixed bug related to handling of non-persistent buffers. They would get added to the <code>state_dict()</code> even if they should not. (<a href="https://github.com/mlverse/torch/issues/1036" class="external-link">#1036</a>)</li>
<li>Fixed a typo in the <code>optim_adamw</code> class name.</li>
<li>Fixed <code>nn_cross_entropy_loss</code> class name. (<a href="https://github.com/mlverse/torch/issues/1043" class="external-link">#1043</a>)</li>
<li>Fixed bug in LBFGS w/ line search. (<a href="https://github.com/mlverse/torch/issues/1048" class="external-link">#1048</a>)</li>
<li>Correctly handle the installation when <code>RemoteSha</code> is a package version. (<a href="https://github.com/mlverse/torch/issues/1058" class="external-link">#1058</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="internal-0-11-0">Internal<a class="anchor" aria-label="anchor" href="#internal-0-11-0"></a></h3>
<ul><li>Started building LibLantern on macOS 11 instead of macOS12 for maximum compatibility. (<a href="https://github.com/mlverse/torch/issues/1026" class="external-link">#1026</a>)</li>
<li>Added <code>CXXSTD</code> to Makevars to enable C+11 compilation options.</li>
<li>Refactored codepath for TensorOptions and now all tensors initialization are handled by the same codepath. (<a href="https://github.com/mlverse/torch/issues/1033" class="external-link">#1033</a>)</li>
<li>Added internal argument <code>.refer_to_state_dict</code> to the <code><a href="../reference/load_state_dict.html">load_state_dict()</a></code> <code><a href="../reference/nn_module.html">nn_module()</a></code> method. Allows loading the state dict into the model keeping parmaters as references to that state dict. (<a href="https://github.com/mlverse/torch/issues/1036" class="external-link">#1036</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.10.0" id="torch-0100">torch 0.10.0<a class="anchor" aria-label="anchor" href="#torch-0100"></a></h2><p class="text-muted">CRAN release: 2023-04-13</p>
<div class="section level3">
<h3 id="breaking-changes-0-10-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-10-0"></a></h3>
<ul><li>Updated to LibTorch v1.13.1 (<a href="https://github.com/mlverse/torch/issues/977" class="external-link">#977</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-10-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-10-0"></a></h3>
<ul><li>Provide pre-built binaries for torch using a GH Action workflow. (<a href="https://github.com/mlverse/torch/issues/975" class="external-link">#975</a>)</li>
<li>Added <code><a href="../reference/nn_silu.html">nn_silu()</a></code> and <code><a href="../reference/nnf_silu.html">nnf_silu()</a></code>. (<a href="https://github.com/mlverse/torch/issues/985" class="external-link">#985</a>)</li>
<li>Added support for deep cloning <code>nn_module</code>s. (<a href="https://github.com/mlverse/torch/issues/986" class="external-link">#986</a>)</li>
<li>Added <code><a href="../reference/with_no_grad.html">local_no_grad()</a></code> and <code><a href="../reference/with_enable_grad.html">local_enable_grad()</a></code> as alternatives for the <code>with_</code> functions. (<a href="https://github.com/mlverse/torch/issues/990" class="external-link">#990</a>)</li>
<li>Added <code>optim_adamw</code> optimizer. (<a href="https://github.com/mlverse/torch/issues/991" class="external-link">#991</a>)</li>
<li>Added support for automatic mixed precision (<a href="https://github.com/mlverse/torch/issues/996" class="external-link">#996</a>)</li>
<li>Added functionality to temporarily modify the torch seed. (<a href="https://github.com/mlverse/torch/issues/999" class="external-link">#999</a>)</li>
<li>Support for creating torch tensors from raw vectors and back. (<a href="https://github.com/mlverse/torch/issues/1003" class="external-link">#1003</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-10-0">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-10-0"></a></h3>
<ul><li>Dataloaders now preserve the batch dimension when <code>batch_size=1</code> is used. (<a href="https://github.com/mlverse/torch/issues/994" class="external-link">#994</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="internal-0-10-0">Internal<a class="anchor" aria-label="anchor" href="#internal-0-10-0"></a></h3>
<ul><li>Large refactoring of the build system. (<a href="https://github.com/mlverse/torch/issues/964" class="external-link">#964</a>)</li>
<li>Use native symbol registration instead of dynamic lookup. (<a href="https://github.com/mlverse/torch/issues/976" class="external-link">#976</a>)</li>
<li>Returning lists of tensors to R is now much faster. (<a href="https://github.com/mlverse/torch/issues/993" class="external-link">#993</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.9.1" id="torch-091">torch 0.9.1<a class="anchor" aria-label="anchor" href="#torch-091"></a></h2><p class="text-muted">CRAN release: 2023-01-23</p>
<div class="section level3">
<h3 id="breaking-changes-0-9-1">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-9-1"></a></h3>
<ul><li>
<code>torch_where</code> now returns 1-based indices when it’s called with the <code>condition</code> argument only. (<a href="https://github.com/mlverse/torch/issues/951" class="external-link">#951</a>, <a href="https://github.com/skeydan" class="external-link">@skeydan</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-9-1">New features<a class="anchor" aria-label="anchor" href="#new-features-0-9-1"></a></h3>
<ul><li>Added support for nonABI builds on CUDA 11.6. (<a href="https://github.com/mlverse/torch/issues/919" class="external-link">#919</a>)</li>
<li>The <code><a href="../reference/torch_fft_fftfreq.html">torch_fft_fftfreq()</a></code> function is now exported. (<a href="https://github.com/mlverse/torch/issues/950" class="external-link">#950</a>, <a href="https://github.com/skeydan" class="external-link">@skeydan</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-9-1">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-9-1"></a></h3>
<ul><li>Fixed bug that caused <code>distr_normal$sample()</code> not being able to generate reproducible results after setting seeds. (<a href="https://github.com/mlverse/torch/issues/938" class="external-link">#938</a>)</li>
<li>
<code>torch_cat</code> error message now correctly reflects 1-based indexing. (<a href="https://github.com/mlverse/torch/issues/952" class="external-link">#952</a>, <a href="https://github.com/skeydan" class="external-link">@skeydan</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="internal-0-9-1">Internal<a class="anchor" aria-label="anchor" href="#internal-0-9-1"></a></h3>
<ul><li>Fixed warnings in R CMD Check generated by the unsafe use of <code>sprintf</code>. (<a href="https://github.com/mlverse/torch/issues/959" class="external-link">#959</a>, <a href="https://github.com/shikokuchuo" class="external-link">@shikokuchuo</a>)</li>
<li>Import, not suggest <code>glue</code> (<a href="https://github.com/mlverse/torch/issues/960" class="external-link">#960</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.9.0" id="torch-090">torch 0.9.0<a class="anchor" aria-label="anchor" href="#torch-090"></a></h2><p class="text-muted">CRAN release: 2022-10-24</p>
<div class="section level3">
<h3 id="breaking-changes-0-9-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-9-0"></a></h3>
<ul><li>Updated to LibTorch v1.12.1. (<a href="https://github.com/mlverse/torch/issues/889" class="external-link">#889</a>, <a href="https://github.com/mlverse/torch/issues/893" class="external-link">#893</a>, <a href="https://github.com/mlverse/torch/issues/899" class="external-link">#899</a>)</li>
<li>
<code>torch_bincount</code> is now 1-based indexed. (<a href="https://github.com/mlverse/torch/issues/896" class="external-link">#896</a>)</li>
<li>
<code><a href="../reference/torch_movedim.html">torch_movedim()</a></code> and <code>$movedim()</code> are now both 1-based indexed. (<a href="https://github.com/mlverse/torch/issues/905" class="external-link">#905</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-9-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-9-0"></a></h3>
<ul><li>Added <code><a href="../reference/cuda_synchronize.html">cuda_synchronize()</a></code> to allow synchronization of CUDA operations. (<a href="https://github.com/mlverse/torch/issues/887" class="external-link">#887</a>)</li>
<li>Added support for M1 Macs, including creating Tensors in the MPS device. (<a href="https://github.com/mlverse/torch/issues/890" class="external-link">#890</a>)</li>
<li>Added support for CUDA 11.6 on Linux. (<a href="https://github.com/mlverse/torch/issues/902" class="external-link">#902</a>)</li>
<li>Added <code><a href="../reference/cuda_empty_cache.html">cuda_empty_cache()</a></code> to allow freeing memory from the caching allocator to the system. (<a href="https://github.com/mlverse/torch/issues/903" class="external-link">#903</a>)</li>
<li>Added <code>$is_sparse()</code> method to check wether a Tensor is sparse or not. (<a href="https://github.com/mlverse/torch/issues/903" class="external-link">#903</a>)</li>
<li>
<code>dataset_subset</code> now adds a class to the modified dataset that is the same as the original dataset classes postfixed with <code>_subset</code>. (<a href="https://github.com/mlverse/torch/issues/904" class="external-link">#904</a>)</li>
<li>Added <code><a href="../reference/torch_serialize.html">torch_serialize()</a></code> to allow creating a raw vector from torch objects. (<a href="https://github.com/mlverse/torch/issues/908" class="external-link">#908</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-9-0">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-9-0"></a></h3>
<ul><li>Fixed bug in <code>torch_arange</code> that was causing the <code>end</code> value not getting included in the result. (<a href="https://github.com/mlverse/torch/issues/885" class="external-link">#885</a>, <a href="https://github.com/skeydan" class="external-link">@skeydan</a>)</li>
<li>Fixed bug in window functions by setting a default dtype. (<a href="https://github.com/mlverse/torch/issues/886" class="external-link">#886</a>, <a href="https://github.com/skeydan" class="external-link">@skeydan</a>)</li>
<li>Fixed bug when using <code>install_torch(reinstall = TRUE)</code>. (<a href="https://github.com/mlverse/torch/issues/883" class="external-link">#883</a>)</li>
<li>The <code>dims</code> argument in <code>torch_tile()</code> is no longer modified, as it’s not meant to be the a 1-based dimension. (<a href="https://github.com/mlverse/torch/issues/905" class="external-link">#905</a>)</li>
<li>
<code>nn_module$state_diict()</code> now detaches output tensors by default. (<a href="https://github.com/mlverse/torch/issues/916" class="external-link">#916</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="internal-0-9-0">Internal<a class="anchor" aria-label="anchor" href="#internal-0-9-0"></a></h3>
<ul><li>Re-implemented the <code>$</code> method for R7 classes in C/C++ to improve speed when calling methods. (<a href="https://github.com/mlverse/torch/issues/873" class="external-link">#873</a>)</li>
<li>Re-implemented garbage collection logic when calling it from inside a <code>backward()</code> call. This improves speed because we no longer need to call GC everytime backward is called. (<a href="https://github.com/mlverse/torch/issues/873" class="external-link">#873</a>)</li>
<li>We now use a thread pool instead of launching a new thread for backward calls. (<a href="https://github.com/mlverse/torch/issues/883" class="external-link">#883</a>)</li>
<li>Implemented options to allow configuring the activation of garbage collection when allocating more CUDA memory. (<a href="https://github.com/mlverse/torch/issues/883" class="external-link">#883</a>)</li>
<li>Some <code>nnf_</code> functions have been updated to use a single <code>torch_</code> kernel instead of the custom implementation. (<a href="https://github.com/mlverse/torch/issues/896" class="external-link">#896</a>)</li>
<li>Improved performance of dataloaders. (<a href="https://github.com/mlverse/torch/issues/900" class="external-link">#900</a>)</li>
<li>We now let LibTorch query the default generator, this allows one to use <code><a href="../reference/torch_bernoulli.html">torch_bernoulli()</a></code> with <code>device="gpu"</code>. (<a href="https://github.com/mlverse/torch/issues/906" class="external-link">#906</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.8.1" id="torch-081">torch 0.8.1<a class="anchor" aria-label="anchor" href="#torch-081"></a></h2><p class="text-muted">CRAN release: 2022-08-19</p>
<div class="section level3">
<h3 id="breaking-changes-0-8-1">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-8-1"></a></h3>
<ul><li>We now prompt the user before installing torch additional dependencies in interactive environments. This was requested by CRAN maintainers. (<a href="https://github.com/mlverse/torch/issues/864" class="external-link">#864</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-8-1">New features<a class="anchor" aria-label="anchor" href="#new-features-0-8-1"></a></h3>
<ul><li>Dataloaders can now handle logical values. (<a href="https://github.com/mlverse/torch/issues/858" class="external-link">#858</a>, <a href="https://github.com/ryan-heslin" class="external-link">@ryan-heslin</a>)</li>
<li>We now provide builds for Pre CXX11 ABI version of LibTorch. They can be used by setting the environment variable <code>PRECXX11ABI=1</code>. This can be useful in environments with older versions of GLIBC. (<a href="https://github.com/mlverse/torch/issues/870" class="external-link">#870</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-8-1">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-8-1"></a></h3>
<ul><li>Fixed the way errors are passed from dataloaders workers to the main process. Now using new rlang error chaining. (<a href="https://github.com/mlverse/torch/issues/864" class="external-link">#864</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="internal-0-8-1">Internal<a class="anchor" aria-label="anchor" href="#internal-0-8-1"></a></h3>
<ul><li>We can now call GC even if from a backward call (ie, from a different thread) which allows for better memory management. (<a href="https://github.com/mlverse/torch/issues/853" class="external-link">#853</a>)</li>
<li>Fix HTML5 Manual information as resquested by CRAN (<a href="https://github.com/mlverse/torch/issues/869" class="external-link">#869</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.8.0" id="torch-080">torch 0.8.0<a class="anchor" aria-label="anchor" href="#torch-080"></a></h2><p class="text-muted">CRAN release: 2022-06-09</p>
<div class="section level3">
<h3 id="breaking-changes-0-8-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-8-0"></a></h3>
<ul><li>Serialization is now much faster because we avoid base64 encoding the serialized tensors. As a result, files serialized with newer versions of torch can’t be opened with older versions of torch. Set <code>options(torch.serialization_version = 1)</code> if you want your file to be readable by older versions. (<a href="https://github.com/mlverse/torch/issues/803" class="external-link">#803</a>)</li>
<li>Deprecated support for CUDA 10.2 on Windows. (<a href="https://github.com/mlverse/torch/issues/835" class="external-link">#835</a>)</li>
<li>
<code>linalg_matrix_rank</code> and <code>linalg_pinv</code> gained <code>atol</code> and <code>rtol</code> arguments while deprecating <code>tol</code> and <code>rcond</code>. (<a href="https://github.com/mlverse/torch/issues/835" class="external-link">#835</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-8-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-8-0"></a></h3>
<ul><li>Improved auto-detection of CUDA version on Windows. (<a href="https://github.com/mlverse/torch/issues/798" class="external-link">#798</a>, <a href="https://github.com/SvenVw" class="external-link">@SvenVw</a>)</li>
<li>Improved parallel dataloaders performance by using a socket conection to transfer data between workers and the main process. (<a href="https://github.com/mlverse/torch/issues/803" class="external-link">#803</a>)</li>
<li>
<code>keep_graph</code> now defaults to the value of <code>create_graph</code> when calling <code>$backward()</code>. We also renamed it to <code>retain_graph</code> to match PyTorch. (<a href="https://github.com/mlverse/torch/issues/811" class="external-link">#811</a>)</li>
<li>Optimizers created with <code>optimizer</code> now carry the classname in the generator and in instances. Optimizer generators now have the class <code>torch_optimizer_generator</code>. The class of torch optimizers has been renamed from <code>torch_Optimizer</code> to <code>torch_optimizer</code>. (<a href="https://github.com/mlverse/torch/issues/814" class="external-link">#814</a>)</li>
<li>New utility function <code><a href="../reference/nn_prune_head.html">nn_prune_head()</a></code> to prune top layer(s) of a network (<a href="https://github.com/mlverse/torch/issues/819" class="external-link">#819</a> <a href="https://github.com/cregouby" class="external-link">@cregouby</a>)</li>
<li>
<code><a href="../reference/torch_kron.html">torch_kron()</a></code> is now exported (<a href="https://github.com/mlverse/torch/issues/818" class="external-link">#818</a>).</li>
<li>Added <code>nn_embedding_bag</code>. (<a href="https://github.com/mlverse/torch/issues/827" class="external-link">#827</a>, <a href="https://github.com/egillax" class="external-link">@egillax</a>)</li>
<li>
<code>nn_multihead_attention</code> now supports the <code>batch_first</code> option. (<a href="https://github.com/mlverse/torch/issues/828" class="external-link">#828</a>, <a href="https://github.com/jonthegeek" class="external-link">@jonthegeek</a>)</li>
<li>It’s now possible to modify the gradient of a tensor using the syntax <code>x$grad &lt;- new_grad</code>. (<a href="https://github.com/mlverse/torch/issues/832" class="external-link">#832</a>)</li>
<li>
<code><a href="../reference/sampler.html">sampler()</a></code> is now exported allowing to create custom samplers that can be passed to <code><a href="../reference/dataloader.html">dataloader()</a></code>. (<a href="https://github.com/mlverse/torch/issues/833" class="external-link">#833</a>)</li>
<li>Creating <code>nn_module</code>s without a <code>initialize</code> method is now supported. (<a href="https://github.com/mlverse/torch/issues/834" class="external-link">#834</a>)</li>
<li>Added <code>lr_reduce_on_plateau</code> learning rate scheduler. (<a href="https://github.com/mlverse/torch/issues/836" class="external-link">#836</a>, <a href="https://github.com/egillax" class="external-link">@egillax</a>)</li>
<li>
<code>torch_tensor(NULL)</code> no longer fails. It now returns a tensor with no dimensions and no data. (<a href="https://github.com/mlverse/torch/issues/839" class="external-link">#839</a>)</li>
<li>Improved complex numbers handling, including better printing and support for casting from and to R. (<a href="https://github.com/mlverse/torch/issues/844" class="external-link">#844</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-8-0">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-8-0"></a></h3>
<ul><li>Fixed bug in weight decay handling in the Adam optimizer. (<a href="https://github.com/mlverse/torch/issues/824" class="external-link">#824</a>, <a href="https://github.com/egillax" class="external-link">@egillax</a>)</li>
<li>Fixed bug in <code>nn_l1_loss</code>. (<a href="https://github.com/mlverse/torch/issues/825" class="external-link">#825</a>, <a href="https://github.com/sebffischer" class="external-link">@sebffischer</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="documentation-0-8-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-0-8-0"></a></h3>
<ul><li>Nice error message when <code>embed_dim</code> is not divisible by <code>num_heads</code> in <code>nn_multihead_attention</code>. (<a href="https://github.com/mlverse/torch/issues/828" class="external-link">#828</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="internal-0-8-0">Internal<a class="anchor" aria-label="anchor" href="#internal-0-8-0"></a></h3>
<ul><li>Updated to LibTorch v1.11.0. (<a href="https://github.com/mlverse/torch/issues/835" class="external-link">#835</a>)</li>
<li>Moved error message translations into R, this makes easier to add new ones and update the existing. (<a href="https://github.com/mlverse/torch/issues/841" class="external-link">#841</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.7.2" id="torch-072">torch 0.7.2<a class="anchor" aria-label="anchor" href="#torch-072"></a></h2><p class="text-muted">CRAN release: 2022-02-25</p>
<div class="section level3">
<h3 id="bug-fix-0-7-2">Bug fix<a class="anchor" aria-label="anchor" href="#bug-fix-0-7-2"></a></h3>
<ul><li>Fixed vignette building on Windows.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.7.1" id="torch-071">torch 0.7.1<a class="anchor" aria-label="anchor" href="#torch-071"></a></h2><p class="text-muted">CRAN release: 2022-02-25</p>
<div class="section level3">
<h3 id="new-features-0-7-1">New features<a class="anchor" aria-label="anchor" href="#new-features-0-7-1"></a></h3>
<ul><li>Added <code><a href="../reference/cuda_runtime_version.html">cuda_runtime_version()</a></code> to query the CUDA Tolkit version that torch is using. (<a href="https://github.com/mlverse/torch/issues/790" class="external-link">#790</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.7.0" id="torch-070">torch 0.7.0<a class="anchor" aria-label="anchor" href="#torch-070"></a></h2><p class="text-muted">CRAN release: 2022-02-18</p>
<div class="section level3">
<h3 id="breaking-changes-0-7-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-7-0"></a></h3>
<ul><li>
<code>torch_sort</code> and <code>Tensor$sort</code> now return 1-indexed results. (<a href="https://github.com/mlverse/torch/issues/709" class="external-link">#709</a>, <a href="https://github.com/mohamed-180" class="external-link">@mohamed-180</a>)</li>
<li>Support for LibTorch 1.10.2. See also <a href="https://github.com/pytorch/pytorch/releases/tag/v1.10.0" class="external-link">release notes</a> for the PyTorch v1.10. (<a href="https://github.com/mlverse/torch/issues/758" class="external-link">#758</a>, <a href="https://github.com/mlverse/torch/issues/763" class="external-link">#763</a>, <a href="https://github.com/mlverse/torch/issues/775" class="external-link">#775</a>, <a href="https://github.com/hsbadr" class="external-link">@hsbadr</a>).</li>
<li>Changed default <code>dim</code> from <code>1</code> to <code>2</code> in <code>nnf_cosine_similarity</code>. (<a href="https://github.com/mlverse/torch/issues/769" class="external-link">#769</a>)</li>
<li>The default value for arguments of various functions have changed. A bug in the code generation was truncating the default values specially if they were float values that needed more than 6 digit precision. (<a href="https://github.com/mlverse/torch/issues/770" class="external-link">#770</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-7-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-7-0"></a></h3>
<ul><li>
<code>jit_save_for_mobile</code> allows to save a traced model in bytecode form, to be loaded by a <code>LiteModuleLoader</code>. (<a href="https://github.com/mlverse/torch/issues/713" class="external-link">#713</a>)</li>
<li>Exported <code>is_torch_tensor</code> to check wether an object is a tensor or not. (<a href="https://github.com/mlverse/torch/issues/730" class="external-link">#730</a>, <a href="https://github.com/rdinnager" class="external-link">@rdinnager</a>)</li>
<li>Adds <code>cuda_get_device_properties(device)</code> that allows one to query device capability and other properties. (<a href="https://github.com/mlverse/torch/issues/734" class="external-link">#734</a>, <a href="https://github.com/rdinnager" class="external-link">@rdinnager</a>)</li>
<li>Implemented <code><a href="../reference/call_torch_function.html">call_torch_function()</a></code> to allow calling potentially unexported torch core functions. (<a href="https://github.com/mlverse/torch/issues/743" class="external-link">#743</a>, <a href="https://github.com/rdinnager" class="external-link">@rdinnager</a>)</li>
<li>Now when installing torch all of LibTorch and Lantern headers will be installed within the <code>inst</code> directory. This will allow for packages extending torch to bind directly to its C++ library. (<a href="https://github.com/mlverse/torch/issues/718" class="external-link">#718</a>)</li>
<li>
<code>dataset_subset</code> will use the <code>.getbatch</code> method of the wrapped dataset if one is available. (<a href="https://github.com/mlverse/torch/issues/742" class="external-link">#742</a>, <a href="https://github.com/egillax" class="external-link">@egillax</a>)</li>
<li>Added <code>nn_flatten</code> and <code>nn_unflatten</code> modules. (<a href="https://github.com/mlverse/torch/issues/773" class="external-link">#773</a>)</li>
<li>Added <code><a href="../reference/cuda_memory_stats.html">cuda_memory_stats()</a></code> and <code><a href="../reference/cuda_memory_stats.html">cuda_memory_summary()</a></code> to verify the amount of memory torch is using from the GPU. (<a href="https://github.com/mlverse/torch/issues/774" class="external-link">#774</a>)</li>
<li>Added <code><a href="../reference/backends_cudnn_version.html">backends_cudnn_version()</a></code> to query the CuDNN version found by torch. (<a href="https://github.com/mlverse/torch/issues/774" class="external-link">#774</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-7-0">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-7-0"></a></h3>
<ul><li>Fixed a bug in <code>.validate_sample</code> for the <code>Distribution</code> class that would incorrectly check for tensors. (<a href="https://github.com/mlverse/torch/issues/739" class="external-link">#739</a>, <a href="https://github.com/hsbadr" class="external-link">@hsbadr</a>)</li>
<li>Fixed memory leak when applying custom <code>autograd_function</code>s. (<a href="https://github.com/mlverse/torch/issues/750" class="external-link">#750</a>)</li>
<li>Fixed a bug that caused <code>autograd_grad</code> to deadlock when used with custom autograd functions. (<a href="https://github.com/mlverse/torch/issues/771" class="external-link">#771</a>)</li>
<li>Fixed a bug in <code>torch_max</code> and <code>torch_min</code> that would fail with <code>length=2</code> Tensors. (<a href="https://github.com/mlverse/torch/issues/772" class="external-link">#772</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="documentation-0-7-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-0-7-0"></a></h3>
<ul><li>Improved the ‘Loading data’ vignette and datasets documentation. (<a href="https://github.com/mlverse/torch/issues/780" class="external-link">#780</a>, <a href="https://github.com/jnolis" class="external-link">@jnolis</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="internal-0-7-0">Internal<a class="anchor" aria-label="anchor" href="#internal-0-7-0"></a></h3>
<ul><li>Refactored the internal Lantern types and Rcpp types and made clearer which are the exported types that can be used in the C++ extensions. (<a href="https://github.com/mlverse/torch/issues/718" class="external-link">#718</a>)</li>
<li>Simplified concurrency related constructs in autograd. (<a href="https://github.com/mlverse/torch/issues/755" class="external-link">#755</a>, <a href="https://github.com/yitao-li" class="external-link">@yitao-li</a>)</li>
<li>R and C++ code cleanup, styling, and formatting. (<a href="https://github.com/mlverse/torch/issues/753" class="external-link">#753</a>, <a href="https://github.com/hsbadr" class="external-link">@hsbadr</a>)</li>
<li>Dataloaders are slightly faster with a new transpose function. (<a href="https://github.com/mlverse/torch/issues/783" class="external-link">#783</a>)</li>
<li>
<code>torch_tensor</code> is now a C++ only function slighly increasing performance in a few situations. (<a href="https://github.com/mlverse/torch/issues/784" class="external-link">#784</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.6.1" id="torch-061">torch 0.6.1<a class="anchor" aria-label="anchor" href="#torch-061"></a></h2>
<div class="section level3">
<h3 id="new-features-0-6-1">New features<a class="anchor" aria-label="anchor" href="#new-features-0-6-1"></a></h3>
<ul><li>Fixed valgrind errors on CRAN by requiring a more recent version of knitr.</li>
<li>Updated LibTorch to version 1.9.1 (<a href="https://github.com/mlverse/torch/issues/725" class="external-link">#725</a> <a href="https://github.com/hsbadr" class="external-link">@hsbadr</a>)</li>
<li>We now check if lantern DLL’s are loaded before calling any lantern function. This avoids segfaults when Lantern is not installed. (<a href="https://github.com/mlverse/torch/issues/723" class="external-link">#723</a>).</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.6.0" id="torch-060">torch 0.6.0<a class="anchor" aria-label="anchor" href="#torch-060"></a></h2><p class="text-muted">CRAN release: 2021-10-07</p>
<div class="section level3">
<h3 id="breaking-changes-0-6-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-6-0"></a></h3>
<ul><li>
<code>nn_sequential</code> is now a bare <code>nn_module</code>, allowing to easily inherit from it. This is a breaking change if you used the <code>name</code> argument. The <code>name</code> behavior can be achieved by subclassing; see the tests in the PR. (<a href="https://github.com/mlverse/torch/issues/699" class="external-link">#699</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-6-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-6-0"></a></h3>
<ul><li>Additional info is showed when printing tensors like if it requires grad and the grad fn. (<a href="https://github.com/mlverse/torch/issues/668" class="external-link">#668</a>, <a href="https://github.com/mlverse/torch/issues/669" class="external-link">#669</a>, <a href="https://github.com/mlverse/torch/issues/673" class="external-link">#673</a>, <a href="https://github.com/mohamed-180" class="external-link">@mohamed-180</a>)</li>
<li>We can now subset <code>nn_sequential</code> modules using <code>[</code>. (<a href="https://github.com/mlverse/torch/issues/678" class="external-link">#678</a>, <a href="https://github.com/mohamed-180" class="external-link">@mohamed-180</a>)</li>
<li>We now allow <code>padding='same'</code> and <code>padding='valid'</code> when using convolutions. (<a href="https://github.com/mlverse/torch/issues/679" class="external-link">#679</a>)</li>
<li>
<code>nnf_cross_entropy</code> now uses the ATen <code>cross_entropy</code> operation directly instead of doing logsoftmax + NLLLoss. (<a href="https://github.com/mlverse/torch/issues/680" class="external-link">#680</a>)</li>
<li>Inherited classes are now persisted by subclasses. This is specially useful if you subclass <code>nn_sequential</code> and still want that the specific S3 methods still work. (<a href="https://github.com/mlverse/torch/issues/701" class="external-link">#701</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-6-0">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-6-0"></a></h3>
<ul><li>Fixed bug when indexing with numeric vectors. (<a href="https://github.com/mlverse/torch/issues/693" class="external-link">#693</a>, <a href="https://github.com/mohamed-180" class="external-link">@mohamed-180</a>)</li>
<li>Fixed bug when indexing tensors with ellipsis and a tensor. (<a href="https://github.com/mlverse/torch/issues/696" class="external-link">#696</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="documentation-0-6-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-0-6-0"></a></h3>
<ul><li>Improved optimizer documentation by adding a ‘Warning’ regarding the creation and usage order. (<a href="https://github.com/mlverse/torch/issues/698" class="external-link">#698</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.5.0" id="torch-050">torch 0.5.0<a class="anchor" aria-label="anchor" href="#torch-050"></a></h2><p class="text-muted">CRAN release: 2021-08-17</p>
<div class="section level3">
<h3 id="breaking-changes-0-5-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-5-0"></a></h3>
<ul><li>Droped support for CUDA 10.1 (<a href="https://github.com/mlverse/torch/issues/610" class="external-link">#610</a>)</li>
<li>
<code><a href="../reference/torch_manual_seed.html">torch_manual_seed()</a></code> now matches PyTorch’s behavior so we can more easily compare implementations. Since this is a breaking change we added the <code>torch.old_seed_behavior=TRUE</code> option so users can stick to the old behavior. (<a href="https://github.com/mlverse/torch/issues/639" class="external-link">#639</a>)</li>
<li>Indexing with vectors has a now the same behavior as R indexing, making it easier to understand. Users can still use the old behavior by using <code>torch_index</code> or <code>torch_index_put</code>. (<a href="https://github.com/mlverse/torch/issues/649" class="external-link">#649</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-5-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-5-0"></a></h3>
<ul><li>Added support for ScriptModule. Loaded JIT modules now operate as <code>nn_module</code>s. (<a href="https://github.com/mlverse/torch/issues/593" class="external-link">#593</a>)</li>
<li>Added a <code>jit_compile</code> function that allows compiling arbitrary TorchScript code into script function that can be serialized and executed. (<a href="https://github.com/mlverse/torch/issues/601" class="external-link">#601</a>)</li>
<li>Added <code>jit_trace</code> support for <code>nn_module</code> created from R. (<a href="https://github.com/mlverse/torch/issues/604" class="external-link">#604</a>)</li>
<li>Updated LibTorch to version 1.9.0 (<a href="https://github.com/mlverse/torch/issues/610" class="external-link">#610</a>)</li>
<li>Added Linear Algebra functions (<a href="https://github.com/mlverse/torch/issues/612" class="external-link">#612</a>)</li>
<li>Added <code>contrib_sort_vertices</code> to efficiently sort vertices on CUDA. (<a href="https://github.com/mlverse/torch/issues/619" class="external-link">#619</a>)</li>
<li>Allows querying the graph from traced modules. (<a href="https://github.com/mlverse/torch/issues/623" class="external-link">#623</a>)</li>
<li>Added <code>with_detect_anomaly</code> to debug autograd errors. (<a href="https://github.com/mlverse/torch/issues/628" class="external-link">#628</a>)</li>
<li>Implemented <code>traced_module$graph_for()</code> to allow inspecting the optimized jit graph. (<a href="https://github.com/mlverse/torch/issues/643" class="external-link">#643</a>)</li>
<li>Added <code>slc</code> to allow dynamically creating slices when indexing tensors. (<a href="https://github.com/mlverse/torch/issues/648" class="external-link">#648</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-5-0">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-5-0"></a></h3>
<ul><li>Fixed a bug when using a <code>.getbatch</code> method that didn’t return a <code>torch_tensor</code>. (<a href="https://github.com/mlverse/torch/issues/615" class="external-link">#615</a>)</li>
<li>Fixed warning when using <code>%/%</code> caused by a call to deprecated <code>torch_floor_divide</code> (<a href="https://github.com/mlverse/torch/issues/616" class="external-link">#616</a>)</li>
<li>Improved CUDA version auto-detection (<a href="https://github.com/mlverse/torch/issues/644" class="external-link">#644</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="internal-changes-0-5-0">Internal changes<a class="anchor" aria-label="anchor" href="#internal-changes-0-5-0"></a></h3>
<ul><li>Improved R &lt;-&gt; JIT types conversion. (<a href="https://github.com/mlverse/torch/issues/593" class="external-link">#593</a>)</li>
<li>Added Dockerfiles for CUDA 11.1 (<a href="https://github.com/mlverse/torch/issues/597" class="external-link">#597</a>)</li>
<li>A warning is raised when an incompatible dataset is passed to a parallel dataloader. (<a href="https://github.com/mlverse/torch/issues/626" class="external-link">#626</a>)</li>
<li>Additionally to calling <code>gc</code> when CUDA memory is exhausted we now call <code>R_RunPendingFinalizers</code>. This should improve memory usage, because we will now delete tensors earlier. (<a href="https://github.com/mlverse/torch/issues/654" class="external-link">#654</a>)</li>
<li>Fix rchk issues (<a href="https://github.com/mlverse/torch/issues/667" class="external-link">#667</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.4.0" id="torch-040">torch 0.4.0<a class="anchor" aria-label="anchor" href="#torch-040"></a></h2><p class="text-muted">CRAN release: 2021-06-10</p>
<div class="section level3">
<h3 id="breaking-changes-0-4-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-4-0"></a></h3>
<ul><li>
<code>torch_multinomial</code> now returns 1-based indexes to comply with 1-based indexing across torch. (<a href="https://github.com/mlverse/torch/issues/588" class="external-link">#588</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-4-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-4-0"></a></h3>
<ul><li>Added parameter to multihead attention module to allow output of unaveraged attention weights. (<a href="https://github.com/jonathanbratt" class="external-link">@jonathanbratt</a> <a href="https://github.com/mlverse/torch/issues/542" class="external-link">#542</a>)</li>
<li>We now allow <code>jit_trace</code> functions with more than 1 argument. (<a href="https://github.com/mlverse/torch/issues/544" class="external-link">#544</a>)</li>
<li>Added Multivariate normal distribution (<a href="https://github.com/mlverse/torch/issues/552" class="external-link">#552</a>)</li>
<li>Export the <code>torch_diff</code> function and added docs for it. (<a href="https://github.com/mlverse/torch/issues/565" class="external-link">#565</a>)</li>
<li>Added a <code>device</code> argument to <code><a href="../reference/torch_load.html">torch_load()</a></code> allowing one to select to which device parameters should be loaded. (<a href="https://github.com/mlverse/torch/issues/578" class="external-link">#578</a>)</li>
<li>Added <code><a href="../reference/distr_categorical.html">distr_categorical()</a></code> (<a href="https://github.com/mlverse/torch/issues/576" class="external-link">#576</a>)</li>
<li>Added <code><a href="../reference/distr_mixture_same_family.html">distr_mixture_same_family()</a></code> (<a href="https://github.com/mlverse/torch/issues/576" class="external-link">#576</a>)</li>
<li>Improve handling of optimizers state and implement <code><a href="../reference/load_state_dict.html">load_state_dict()</a></code> and <code>state_dict()</code> for optimizers. (<a href="https://github.com/mlverse/torch/issues/585" class="external-link">#585</a>)</li>
<li>Added the ability to save R <code>list</code>s containing <code>torch_tensor</code>s using <code>torch_save</code>. This allows us to save the state of optimizers and modules using <code><a href="../reference/torch_save.html">torch_save()</a></code>. (<a href="https://github.com/mlverse/torch/issues/586" class="external-link">#586</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-4-0">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-4-0"></a></h3>
<ul><li>Fixed bug in <code>nn_multihead_attention</code> when q,k,v inputs not all the same. (<a href="https://github.com/jonathanbratt" class="external-link">@jonathanbratt</a> <a href="https://github.com/mlverse/torch/issues/540" class="external-link">#540</a>)</li>
<li>Fixed <code>$copy_</code> so it correctly respects the src <code>requires_grad()</code> when reloading saved models with <code><a href="../reference/torch_load.html">torch_load()</a></code>. (<a href="https://github.com/mlverse/torch/issues/545" class="external-link">#545</a>)</li>
<li>Fixed <code><a href="../reference/nn_init_xavier_normal_.html">nn_init_xavier_normal_()</a></code> and <code><a href="../reference/nn_init_xavier_uniform_.html">nn_init_xavier_uniform_()</a></code> standard deviation calculation. (<a href="https://github.com/mlverse/torch/issues/557" class="external-link">#557</a>)</li>
<li>Fixed bug in <code><a href="../reference/torch_tensordot.html">torch_tensordot()</a></code> when called when infering dimensions. (<a href="https://github.com/mlverse/torch/issues/563" class="external-link">#563</a>)</li>
<li>Dataset’s <code>.getbatch</code> now takes an integer vector as input instead of a <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>. (<a href="https://github.com/mlverse/torch/issues/572" class="external-link">#572</a>)</li>
<li>Fixed bug with <code>tensor$size()</code> when indexing with negative numbers. (<a href="https://github.com/mlverse/torch/issues/570" class="external-link">#570</a>)</li>
<li>Fixed bug in the <code>log_prob</code> of <code><a href="../reference/distr_bernoulli.html">distr_bernoulli()</a></code> (<a href="https://github.com/mlverse/torch/issues/581" class="external-link">#581</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="internal-changes-0-4-0">Internal changes<a class="anchor" aria-label="anchor" href="#internal-changes-0-4-0"></a></h3>
<ul><li>Better handling optional Tensor arguments by using an explicit <code>XPtrTorchOptionalTensor</code> class. (<a href="https://github.com/mlverse/torch/issues/565" class="external-link">#565</a>)</li>
<li>Tensors in the R side that point to the same C++ Tensor are now guaranteed to be the same object. This allows to easily determine unique model parameters. (<a href="https://github.com/mlverse/torch/issues/582" class="external-link">#582</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.0" id="torch-030">torch 0.3.0<a class="anchor" aria-label="anchor" href="#torch-030"></a></h2><p class="text-muted">CRAN release: 2021-04-28</p>
<div class="section level3">
<h3 id="breaking-changes-0-3-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-3-0"></a></h3>
<ul><li>
<code>torch_nonzero</code> and <code>tensor$nonzero()</code> now return 1-based indexes. (<a href="https://github.com/mlverse/torch/issues/432" class="external-link">#432</a>)</li>
<li>Breaking change: <code>torch_arange</code> returns in the closed interval <code>[start, end]</code> instead of the half open <code>[start, end)</code>. This makes it behave similar to R’s <code>seq</code>. (<a href="https://github.com/mlverse/torch/issues/506" class="external-link">#506</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-3-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-3-0"></a></h3>
<ul><li>
<code>torch_split</code> now accepts a list of sizes as well as a fixed size. (<a href="https://github.com/mlverse/torch/issues/429" class="external-link">#429</a>)</li>
<li>Added <code>nn_layer_norm</code>. (<a href="https://github.com/mlverse/torch/issues/435" class="external-link">#435</a>)</li>
<li>Allow <code>timeout=360</code> as <code><a href="../reference/install_torch.html">install_torch()</a></code> parameter for large file download (<a href="https://github.com/cregouby" class="external-link">@cregouby</a> <a href="https://github.com/mlverse/torch/issues/438" class="external-link">#438</a>)</li>
<li>Added <code><a href="../reference/install_torch_from_file.html">install_torch_from_file()</a></code> and <code><a href="../reference/install_torch_from_file.html">get_install_libs_url()</a></code>for setup cases where direct download is not possible (<a href="https://github.com/cregouby" class="external-link">@cregouby</a> <a href="https://github.com/mlverse/torch/issues/439" class="external-link">#439</a>)</li>
<li>Added <code>mean.torch_tensor</code> (<a href="https://github.com/mlverse/torch/issues/448" class="external-link">#448</a>)</li>
<li>New arguments <code>worker_globals</code> and <code>worker_packages</code> allowing to easily pass objects to workers in parallel dataloaders (<a href="https://github.com/mlverse/torch/issues/449" class="external-link">#449</a>).</li>
<li>We now call R garbage collector when there’s no memory available on GPU, this can help in a few cases when the laziness of the garbage collector allows too many tensors to be on memory even though they are no longer referenced in R. (<a href="https://github.com/mlverse/torch/issues/456" class="external-link">#456</a>)</li>
<li>Implemented <code>nn_group_norm</code> and fixed a bug in <code>nnf_group_norm</code> (<a href="https://github.com/mlverse/torch/issues/474" class="external-link">#474</a>)</li>
<li>Added backend functions allowing us to query which optimizations LibTorch was compiled with (<a href="https://github.com/mlverse/torch/issues/476" class="external-link">#476</a>)</li>
<li>Added normal distribution (<a href="https://github.com/mlverse/torch/issues/462" class="external-link">#462</a>)</li>
<li>Added bernoulli distribution (<a href="https://github.com/mlverse/torch/issues/484" class="external-link">#484</a>)</li>
<li>
<code>as.list</code> for <code>nn_modules</code> (<a href="https://github.com/mlverse/torch/issues/492" class="external-link">#492</a>)</li>
<li>Enumerate support in Bernoulli distribution (<a href="https://github.com/mlverse/torch/issues/490" class="external-link">#490</a>)</li>
<li>Added Poisson Distriibution (<a href="https://github.com/mlverse/torch/issues/495" class="external-link">#495</a>)</li>
<li>Allow optional .getbatch in datasets/dataloaders (<a href="https://github.com/mlverse/torch/issues/498" class="external-link">#498</a>)</li>
<li>
<code>nn_lstm</code>, <code>nn_gru</code> and <code>nn_gru</code> can now use cudnn accelerations when available (<a href="https://github.com/mlverse/torch/issues/503" class="external-link">#503</a>).</li>
<li>Added Gamma distribution (<a href="https://github.com/mlverse/torch/issues/489" class="external-link">#489</a>)</li>
<li>We now respect the TORCH_HOME env var to automatically install torch. (<a href="https://github.com/mlverse/torch/issues/522" class="external-link">#522</a>)</li>
<li>Implement comparison operator <code>!=</code> for torch dtypes. (<a href="https://github.com/mlverse/torch/issues/524" class="external-link">#524</a>)</li>
<li>Added Chi-square distribution. (<a href="https://github.com/mlverse/torch/issues/518" class="external-link">#518</a>)</li>
<li>Added <code>optimizer</code> function allowing to easily implement custom optimizers. (<a href="https://github.com/mlverse/torch/issues/527" class="external-link">#527</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-3-0">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-3-0"></a></h3>
<ul><li>Fixed bug in <code>optim_lbfgs</code> that would make model objects exponentially big. (<a href="https://github.com/mlverse/torch/issues/431" class="external-link">#431</a>)</li>
<li>Correctly handle <code>NaN</code>s in L-BFGS optimizer (<a href="https://github.com/mlverse/torch/issues/433" class="external-link">#433</a>)</li>
<li>The default collate function now respects the data type when converting to a tensor (if the dataset returns an R object) (<a href="https://github.com/mlverse/torch/issues/434" class="external-link">#434</a>)</li>
<li>Fixed <code>torch_normal</code>. (<a href="https://github.com/mlverse/torch/issues/450" class="external-link">#450</a>)</li>
<li>Fixed backward compatibility issue when loading models saved in older versions of torch. This bug was introduced in <a href="https://github.com/mlverse/torch/issues/452" class="external-link">#452</a> and is now fixed and we also added a regression test. (<a href="https://github.com/mlverse/torch/issues/458" class="external-link">#458</a>)</li>
<li>Fixed bug when using RNN’s on the GPU (<a href="https://github.com/mlverse/torch/issues/460" class="external-link">#460</a>)</li>
<li>Found and fixed some memory leaks, specially when creating datatypes from strings and when saving models with <code>torch_save</code>. (<a href="https://github.com/mlverse/torch/issues/454" class="external-link">#454</a>)</li>
<li>Fixed bug in <code>nnf_pad</code> when using <code>mode='circular'</code>. (<a href="https://github.com/mlverse/torch/issues/471" class="external-link">#471</a>)</li>
<li>Bugfixes in <code>nn_multihead_attention</code> (<a href="https://github.com/mlverse/torch/issues/496" class="external-link">#496</a>)</li>
<li>Fixed bug when using packed sequences with <code>nn_lstm</code> (<a href="https://github.com/mlverse/torch/issues/500" class="external-link">#500</a>)</li>
<li>Fixed bug in the <code>to</code> method of <code>nn_module</code> that would reset the <code>requires_grad</code> attribute of parameters. (<a href="https://github.com/mlverse/torch/issues/501" class="external-link">#501</a>)</li>
<li>Added <code>strong_wolfe</code> option to <code>optim_lbfgs</code>. (<a href="https://github.com/mlverse/torch/issues/517" class="external-link">#517</a>)</li>
<li>Fixed default argument of <code>nn_init_trunc_normal_</code> initializer function. (<a href="https://github.com/mlverse/torch/issues/535" class="external-link">#535</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="documentation-0-3-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-0-3-0"></a></h3>
<ul><li>Added vignette on reading models from Python (<a href="https://github.com/mlverse/torch/issues/469" class="external-link">#469</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="internal-changes-0-3-0">Internal changes<a class="anchor" aria-label="anchor" href="#internal-changes-0-3-0"></a></h3>
<ul><li>Removed the PerformanceReporter from tests to get easier to read stack traces. (<a href="https://github.com/mlverse/torch/issues/449" class="external-link">#449</a>)</li>
<li>Internal change in the R7 classes so R7 objects are simple external pointer instead of environments. This might cause breaking change if you relied on saving any kind of state in the Tensor object. (<a href="https://github.com/mlverse/torch/issues/452" class="external-link">#452</a>)</li>
<li>Internal refactoring making Rcpp aware of some XPtrTorch* types so making it simpler to return them from Rcpp code. This might cause a breaking change if you are relying on <code><a href="../reference/torch_dtype.html">torch_dtype()</a></code> being an R6 class. (<a href="https://github.com/mlverse/torch/issues/451" class="external-link">#451</a>)</li>
<li>Internal changes to auto unwrap arguments from SEXP’s in Rcpp. This will make easier to move the dispatcher system to C++ in the future, but already allows us to gain ~30% speedups in small operations. (<a href="https://github.com/mlverse/torch/issues/454" class="external-link">#454</a>)</li>
<li>Added a Windows GPU CI workflow (<a href="https://github.com/mlverse/torch/issues/508" class="external-link">#508</a>).</li>
<li>Update to LibTorch v1.8 (<a href="https://github.com/mlverse/torch/issues/513" class="external-link">#513</a>)</li>
<li>Moved some parts of the dispatcher to C++ to make it faster. (<a href="https://github.com/mlverse/torch/issues/520" class="external-link">#520</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.1" id="torch-021">torch 0.2.1<a class="anchor" aria-label="anchor" href="#torch-021"></a></h2><p class="text-muted">CRAN release: 2021-01-05</p>
<div class="section level3">
<h3 id="breaking-changes-0-2-1">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-2-1"></a></h3>
<ul><li>Made <code>torch_one_hot</code> and <code>nnf_one_hot</code> use 1-based indexing. (<a href="https://github.com/mlverse/torch/issues/410" class="external-link">#410</a>)</li>
<li>
<code>nn_module$eval()</code> and <code>nn_module$train()</code> now return a callable <code>nn_module</code> instead of a <code>nn_Module</code>. (<a href="https://github.com/mlverse/torch/issues/425" class="external-link">#425</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-2-1">New features<a class="anchor" aria-label="anchor" href="#new-features-0-2-1"></a></h3>
<ul><li>Added a custom CPU allocator to call <code>gc</code> when torch might need more memory (<a href="https://github.com/mlverse/torch/issues/402" class="external-link">#402</a>)</li>
<li>Updated to LibTorch 1.7.1 (<a href="https://github.com/mlverse/torch/issues/412" class="external-link">#412</a>)</li>
<li>Allow listing all nested modules in a <code>nn_module</code> (<a href="https://github.com/mlverse/torch/issues/417" class="external-link">#417</a>)</li>
<li>Allow modifying the <code>requires_grad</code> attribute using the <code>$&lt;-</code> operator (<a href="https://github.com/mlverse/torch/issues/419" class="external-link">#419</a>)</li>
<li>Added <code>length</code> method for the <code>nn_sequential</code> container. (<a href="https://github.com/mlverse/torch/issues/423" class="external-link">#423</a>)</li>
<li>Added support for CUDA 11 on linux (<a href="https://github.com/mlverse/torch/issues/424" class="external-link">#424</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-2-1">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-2-1"></a></h3>
<ul><li>Fix support for cuda 9.2 (<a href="https://github.com/mlverse/torch/issues/398" class="external-link">#398</a>)</li>
<li>Fixed GPU CI that was skipping tests. (<a href="https://github.com/mlverse/torch/issues/398" class="external-link">#398</a>)</li>
<li>Fixed a memory leak when printing tensors (<a href="https://github.com/mlverse/torch/issues/402" class="external-link">#402</a>)</li>
<li>Fixed a memory leak when passing integer vectors to lantern. (<a href="https://github.com/mlverse/torch/issues/402" class="external-link">#402</a>)</li>
<li>Fixed a few more memory leaks related to autograd context (<a href="https://github.com/mlverse/torch/issues/405" class="external-link">#405</a>)</li>
<li>Fixed <code>nnf_normalize</code> and <code>x$norm()</code> as they were not able to be called (<a href="https://github.com/mlverse/torch/issues/409" class="external-link">#409</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="documentation-0-2-1">Documentation<a class="anchor" aria-label="anchor" href="#documentation-0-2-1"></a></h3>
<ul><li>Small improvement to <code>nn_module</code> documentation (<a href="https://github.com/mlverse/torch/issues/399" class="external-link">#399</a>).</li>
<li>The getting started section has been removed from the pkgdown website in favor of the new guide in the landing page (<a href="https://github.com/mlverse/torch/issues/401" class="external-link">#401</a>)</li>
<li>Updated the landing page to include a getting started tutorial (<a href="https://github.com/mlverse/torch/issues/400" class="external-link">#400</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.0" id="torch-020">torch 0.2.0<a class="anchor" aria-label="anchor" href="#torch-020"></a></h2><p class="text-muted">CRAN release: 2020-12-15</p>
<div class="section level3">
<h3 id="breaking-changes-0-2-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-2-0"></a></h3>
<ul><li>Dataloaders now returns a <code><a href="https://rdrr.io/pkg/coro/man/iterator.html" class="external-link">coro::exhausted</a></code> intead of raising <code>stop_iteration_error</code> when the dataloader exceeds. (<a href="https://github.com/mlverse/torch/issues/366" class="external-link">#366</a>)</li>
<li>Fixed bug that would happen with functions that need to transform tensors from 0-based to 1-based in the GPU. (<a href="https://github.com/mlverse/torch/issues/317" class="external-link">#317</a>)</li>
<li>Fixed <code>torch_argsort</code> and <code>x$argsort</code> to return 1-based indexes (<a href="https://github.com/mlverse/torch/issues/342" class="external-link">#342</a>)</li>
<li>Fixed <code>torch_argmax</code>, <code>torch_argmin</code>, <code>x$argmax()</code> and <code>x$argmin()</code> return 1-based indexes. (<a href="https://github.com/mlverse/torch/issues/389" class="external-link">#389</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-2-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-2-0"></a></h3>
<ul><li>Added <code>$element_size()</code> method (<a href="https://github.com/dirkschumacher" class="external-link">@dirkschumacher</a> <a href="https://github.com/mlverse/torch/issues/322" class="external-link">#322</a>)</li>
<li>Added <code>$bool()</code> method (<a href="https://github.com/dirkschumacher" class="external-link">@dirkschumacher</a> <a href="https://github.com/mlverse/torch/issues/323" class="external-link">#323</a>)</li>
<li>
<code>torch__addr</code> and <code>torch__addr_</code> have been removed as they are no longer available in LibTorch 1.7.</li>
<li>We now check the MD5 hashes of downloaded LibTorch binaries. (<a href="https://github.com/dirkschumacher" class="external-link">@dirkschumacher</a> <a href="https://github.com/mlverse/torch/issues/325" class="external-link">#325</a>)</li>
<li>Added a Distribution abstract class (<a href="https://github.com/krzjoa" class="external-link">@krzjoa</a> <a href="https://github.com/mlverse/torch/issues/333" class="external-link">#333</a>)</li>
<li>Updated to LibTorch 1.7 (<a href="https://github.com/mlverse/torch/issues/337" class="external-link">#337</a>)</li>
<li>We now warn when converting <code>long</code> tensors to R and there’s a chance of an integer overflow. (<a href="https://github.com/mlverse/torch/issues/347" class="external-link">#347</a>)</li>
<li>Allow <code>private</code> and <code>active</code> methods in <code>nn_module</code>’s and <code>dataset</code>’s. (<a href="https://github.com/mlverse/torch/issues/349" class="external-link">#349</a>)</li>
<li>Added <code>nn_batch_norm3d</code> (<a href="https://github.com/mattwarkentin" class="external-link">@mattwarkentin</a> <a href="https://github.com/mlverse/torch/issues/354" class="external-link">#354</a>)</li>
<li>Added <code>nn_lstm</code> and <code>nn_gru</code> modules. (<a href="https://github.com/mlverse/torch/issues/362" class="external-link">#362</a>)</li>
<li>Added distribution constraints (<a href="https://github.com/krzjoa" class="external-link">@krzjoa</a> <a href="https://github.com/mlverse/torch/issues/364" class="external-link">#364</a>)</li>
<li>Dataloaders now use the num_workers argument to load data in parallel (<a href="https://github.com/mlverse/torch/issues/366" class="external-link">#366</a>)</li>
<li>Added Exponential Family classs to distributions (<a href="https://github.com/mlverse/torch/issues/373" class="external-link">#373</a>)</li>
<li>Added Dockerfile and docker compose file with GPU support, with a how-to guide. (<a href="https://github.com/mlverse/torch/issues/380" class="external-link">#380</a> <a href="https://github.com/mlverse/torch/issues/386" class="external-link">#386</a>)</li>
<li>Added R 3.6 to the CI system and fixed compilation from source with it on Windows (<a href="https://github.com/mlverse/torch/issues/387" class="external-link">#387</a>)</li>
<li>Initial support for JIT tracing (<a href="https://github.com/mlverse/torch/issues/377" class="external-link">#377</a>)</li>
<li>Added LBFGS optimizer (<a href="https://github.com/mlverse/torch/issues/392" class="external-link">#392</a>)</li>
<li>Improved the <code>nn_module</code> UI by improving autocomplete support and adding a print method (<a href="https://github.com/mlverse/torch/issues/391" class="external-link">#391</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-2-0">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-2-0"></a></h3>
<ul><li>Fixed bug when trying to print the <code>grad_fn</code> of a Tensor that doesn’t have one. See (<a href="https://github.com/mlverse/torch/issues/321" class="external-link">#321</a>)</li>
<li>Refactored the optimizers code to avoid duplication of parameter checks, etc. (<a href="https://github.com/dirkschumacher" class="external-link">@dirkschumacher</a> <a href="https://github.com/mlverse/torch/issues/328" class="external-link">#328</a>)</li>
<li>Fixed <code>torch_norm</code> so it can be called with a <code>dim</code> argument. (<a href="https://github.com/mlverse/torch/issues/345" class="external-link">#345</a>)</li>
<li>Fixed crash when calling <code>torch_hann_window</code> with an invalid <code>NULL</code> <code>window_length</code>. (<a href="https://github.com/mlverse/torch/issues/351" class="external-link">#351</a>)</li>
<li>Fixed <code>torch_stft</code> calls for LibTorch 1.7 (added the <code>return_complex</code> argument) (<a href="https://github.com/mlverse/torch/issues/355" class="external-link">#355</a>)</li>
<li>Fixed bug when strides were NULL in some pooling operations. (<a href="https://github.com/mlverse/torch/issues/361" class="external-link">#361</a>)</li>
<li>Use <code>nvcc --version</code> instead of <code>nvidia-smi</code> to find the CUDA version as <code>nvidia-smi</code> reports the latest supported version and not the installed one. (<a href="https://github.com/mlverse/torch/issues/363" class="external-link">#363</a>)</li>
<li>Corrected URL to download LibTorch under Linux with CUDA 10.2 (<a href="https://github.com/mlverse/torch/issues/367" class="external-link">#367</a>)</li>
<li>Fixed handling of integer tensors when indexing tensors (<a href="https://github.com/mlverse/torch/issues/385" class="external-link">#385</a>)</li>
<li>Fixed bug when passing length zero vectors to lantern/libtorch. (<a href="https://github.com/mlverse/torch/issues/388" class="external-link">#388</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.1" id="torch-011">torch 0.1.1<a class="anchor" aria-label="anchor" href="#torch-011"></a></h2><p class="text-muted">CRAN release: 2020-10-20</p>
<div class="section level3">
<h3 id="bug-fixes-0-1-1">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-1-1"></a></h3>
<ul><li>Fixed bug that made <code>RandomSampler(replacement = TRUE)</code> to never take the last element in the dataset. (84861fa)</li>
<li>Fixed <code>torch_topk</code> and <code>x$topk</code> so the returned indexes are 1-based (<a href="https://github.com/mlverse/torch/issues/280" class="external-link">#280</a>)</li>
<li>Fixed a bug (<a href="https://github.com/mlverse/torch/issues/275" class="external-link">#275</a>) that would cause <code>1 - torch_tensor(1, device = "cuda")</code> to fail because <code>1</code> was created in the CPU. (<a href="https://github.com/mlverse/torch/issues/279" class="external-link">#279</a>)</li>
<li>We now preserve names in the <code>dataloader</code> output (<a href="https://github.com/mlverse/torch/issues/286" class="external-link">#286</a>)</li>
<li>
<code>torch_narrow</code>, <code>Tensor$narrow()</code> and <code>Tensor$narrow_copy</code> are now indexed starting at 1. (<a href="https://github.com/mlverse/torch/issues/294" class="external-link">#294</a>)</li>
<li>
<code>Tensor$is_leaf</code> is now an active method. (<a href="https://github.com/mlverse/torch/issues/295" class="external-link">#295</a>)</li>
<li>Fixed bug when passing equations to <code>torch_einsum</code>. (<a href="https://github.com/mlverse/torch/issues/296" class="external-link">#296</a>)</li>
<li>Fixed <code><a href="../reference/nn_module_list.html">nn_module_list()</a></code> to correctly name added modules, otherwise they are not returned when doing <code>state_dict()</code> on it. (<a href="https://github.com/mlverse/torch/issues/300" class="external-link">#300</a>)</li>
<li>Fixed bug related to random number seeds when using in-place methods. (<a href="https://github.com/mlverse/torch/issues/303" class="external-link">#303</a>)</li>
<li>Fixed <code>nn_batchnorm*</code> so it returns the same results as PyTorch (<a href="https://github.com/mlverse/torch/issues/302" class="external-link">#302</a>)</li>
<li>Fixed a bug that made <code>nn_module$parameter</code> when there were shared parameters between layers. (<a href="https://github.com/mlverse/torch/issues/306" class="external-link">#306</a>)</li>
<li>Fixed <code>$max</code> and <code>$min</code> to return 1-based indexes. (<a href="https://github.com/mlverse/torch/issues/315" class="external-link">#315</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-1-1">New features<a class="anchor" aria-label="anchor" href="#new-features-0-1-1"></a></h3>
<ul><li>Expanded the <code>utils_data_default_collate</code> to support converting R objects to torch tensors when needed. (<a href="https://github.com/mlverse/torch/issues/269" class="external-link">#269</a>)</li>
<li>Added an <code>as.matrix</code> method for torch Tensors. (<a href="https://github.com/mlverse/torch/issues/282" class="external-link">#282</a>)</li>
<li>By default we now truncate the output of <code>print(totrch_tensor(1:40))</code> if it spans for more than 30 lines. This is useful for not spamming the console or taking very long to print when you print a very large tensor. (<a href="https://github.com/mlverse/torch/issues/283" class="external-link">#283</a>)</li>
<li>Added the Adadelta optimizer (<a href="https://github.com/krzjoa" class="external-link">@krzjoa</a> <a href="https://github.com/mlverse/torch/issues/284" class="external-link">#284</a>)</li>
<li>Added support for GPU’s on Windows (<a href="https://github.com/mlverse/torch/issues/281" class="external-link">#281</a>)</li>
<li>Added the Adagrad optimizer (<a href="https://github.com/krzjoa" class="external-link">@krzjoa</a> <a href="https://github.com/mlverse/torch/issues/289" class="external-link">#289</a>)</li>
<li>Added RMSprop optimizer (<a href="https://github.com/krzjoa" class="external-link">@krzjoa</a> <a href="https://github.com/mlverse/torch/issues/290" class="external-link">#290</a>)</li>
<li>Added the Rprop optimizer (<a href="https://github.com/krzjoa" class="external-link">@krzjoa</a> <a href="https://github.com/mlverse/torch/issues/297" class="external-link">#297</a>)</li>
<li>Added gradient clipping utilities (<a href="https://github.com/mlverse/torch/issues/299" class="external-link">#299</a>)</li>
<li>Added <code>nnf_contrib_sparsemax</code> and <code>nn_contrib_sparsemax</code>. (<a href="https://github.com/mlverse/torch/issues/309" class="external-link">#309</a>)</li>
<li>Added ASGD optimizer (<a href="https://github.com/krzjoa" class="external-link">@krzjoa</a> <a href="https://github.com/mlverse/torch/issues/307" class="external-link">#307</a>)</li>
<li>Getters and setters for the number of threads used by torch (<a href="https://github.com/mlverse/torch/issues/311" class="external-link">#311</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.0" id="torch-010">torch 0.1.0<a class="anchor" aria-label="anchor" href="#torch-010"></a></h2><p class="text-muted">CRAN release: 2020-09-28</p>
<ul><li>Added many missing losses (<a href="https://github.com/mlverse/torch/issues/252" class="external-link">#252</a>)</li>
<li>Implemented the <code>$&lt;-</code> and <code>[[&lt;-</code> operators for the <code>nn_module</code> class. (<a href="https://github.com/mlverse/torch/issues/253" class="external-link">#253</a>)</li>
<li>Export <code>nn_parameter</code>, <code>nn_buffer</code>, and <code>is_*</code> auxiliary functions.</li>
<li>Added a new serialization vignette.</li>
<li>Added a few learning rate schedulers (<a href="https://github.com/mlverse/torch/issues/258" class="external-link">#258</a>)</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.2" id="torch-002">torch 0.0.2<a class="anchor" aria-label="anchor" href="#torch-002"></a></h2><p class="text-muted">CRAN release: 2020-08-31</p>
<ul><li>Added a <code>NEWS.md</code> file to track changes to the package.</li>
<li>Auto install when loading the package for the first time.</li>
</ul></div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Falbel, Javier Luraschi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

