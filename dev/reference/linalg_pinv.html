<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Computes the pseudoinverse (Moore-Penrose inverse) of a matrix. — linalg_pinv • torch</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Computes the pseudoinverse (Moore-Penrose inverse) of a matrix. — linalg_pinv"><meta name="description" content="The pseudoinverse may be defined algebraically_
but it is more computationally convenient to understand it through the SVD_
Supports input of float, double, cfloat and cdouble dtypes.
Also supports batches of matrices, and if A is a batch of matrices then
the output has the same batch dimensions."><meta property="og:description" content="The pseudoinverse may be defined algebraically_
but it is more computationally convenient to understand it through the SVD_
Supports input of float, double, cfloat and cdouble dtypes.
Also supports batches of matrices, and if A is a batch of matrices then
the output has the same batch dimensions."><meta name="robots" content="noindex"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-9ZJSKW3L0N"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9ZJSKW3L0N');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">torch</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.16.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/installation.html">Installation</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tensors</h6></li>
    <li><a class="dropdown-item" href="../articles/tensor-creation.html">Creating tensors</a></li>
    <li><a class="dropdown-item" href="../articles/indexing.html">Indexing</a></li>
    <li><a class="dropdown-item" href="../articles/tensor/index.html">Tensor class</a></li>
    <li><a class="dropdown-item" href="../articles/serialization.html">Serialization</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Datasets</h6></li>
    <li><a class="dropdown-item" href="../articles/loading-data.html">Loading Data</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Autograd</h6></li>
    <li><a class="dropdown-item" href="../articles/using-autograd.html">Using autograd</a></li>
    <li><a class="dropdown-item" href="../articles/extending-autograd.html">Extending autograd</a></li>
    <li><a class="dropdown-item" href="../articles/python-to-r.html">Python models</a></li>
    <li><a class="dropdown-item" href="../articles/torchscript.html">Jit Compilation</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples"><li><a class="dropdown-item" href="../articles/examples/basic-autograd.html">basic-autograd</a></li>
    <li><a class="dropdown-item" href="../articles/examples/basic-nn-module.html">basic-nn-module</a></li>
    <li><a class="dropdown-item" href="../articles/examples/dataset.html">dataset</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-advanced" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Advanced</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-advanced"><li><a class="dropdown-item" href="../articles/memory-management.html">Memory management</a></li>
    <li><a class="dropdown-item" href="../articles/compatibility-matrix.html">CUDA compatibility matrix</a></li>
    <li><a class="dropdown-item" href="../articles/modifying-source-code.html">Building locally</a></li>
    <li><a class="dropdown-item" href="../articles/amp.html">Automatic Mixed Precision</a></li>
    <li><a class="dropdown-item" href="../articles/modifying-source-code.html">Modifying source code</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mlverse/torch/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Computes the pseudoinverse (Moore-Penrose inverse) of a matrix.</h1>
      <small class="dont-index">Source: <a href="https://github.com/mlverse/torch/blob/main/R/linalg.R" class="external-link"><code>R/linalg.R</code></a></small>
      <div class="d-none name"><code>linalg_pinv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The pseudoinverse may be <code>defined algebraically</code>_
but it is more computationally convenient to understand it <code>through the SVD</code>_
Supports input of float, double, cfloat and cdouble dtypes.
Also supports batches of matrices, and if <code>A</code> is a batch of matrices then
the output has the same batch dimensions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">linalg_pinv</span><span class="op">(</span><span class="va">A</span>, rcond <span class="op">=</span> <span class="cn">NULL</span>, hermitian <span class="op">=</span> <span class="cn">FALSE</span>, atol <span class="op">=</span> <span class="cn">NULL</span>, rtol <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-a">A<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>(Tensor): tensor of shape <code>(*, m, n)</code> where <code>*</code> is zero or more batch dimensions.</p></dd>


<dt id="arg-rcond">rcond<a class="anchor" aria-label="anchor" href="#arg-rcond"></a></dt>
<dd><p>(float or Tensor, optional): the tolerance value to determine when is a singular value zero
If it is a <code>torch_Tensor</code>, its shape must be
broadcastable to that of the singular values of
<code>A</code> as returned by <code><a href="linalg_svd.html">linalg_svd()</a></code>.
Alias for <code>rtol</code>.
Default: <code>0</code>.</p></dd>


<dt id="arg-hermitian">hermitian<a class="anchor" aria-label="anchor" href="#arg-hermitian"></a></dt>
<dd><p>(bool, optional): indicates whether <code>A</code> is Hermitian if complex
or symmetric if real. Default: <code>FALSE</code>.</p></dd>


<dt id="arg-atol">atol<a class="anchor" aria-label="anchor" href="#arg-atol"></a></dt>
<dd><p>the absolute tolerance value. When <code>NULL</code> it’s considered to be zero.</p></dd>


<dt id="arg-rtol">rtol<a class="anchor" aria-label="anchor" href="#arg-rtol"></a></dt>
<dd><p>the relative tolerance value. See above for the value it takes when <code>NULL</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If <code>hermitian= TRUE</code>, <code>A</code> is assumed to be Hermitian if complex or
symmetric if real, but this is not checked internally. Instead, just the lower
triangular part of the matrix is used in the computations.
The singular values (or the norm of the eigenvalues when <code>hermitian= TRUE</code>)
that are below the specified <code>rcond</code> threshold are treated as zero and discarded
in the computation.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function uses <code><a href="linalg_svd.html">linalg_svd()</a></code> if <code>hermitian= FALSE</code> and
<code><a href="linalg_eigh.html">linalg_eigh()</a></code> if <code>hermitian= TRUE</code>.
For CUDA inputs, this function synchronizes that device with the CPU.</p>
<p>Consider using <code><a href="linalg_lstsq.html">linalg_lstsq()</a></code> if possible for multiplying a matrix on the left by
the pseudoinverse, as <code>linalg_lstsq(A, B)$solution == A$pinv() %*% B</code></p>
<p>It is always prefered to use <code><a href="linalg_lstsq.html">linalg_lstsq()</a></code> when possible, as it is faster and more
numerically stable than computing the pseudoinverse explicitly.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="linalg_inv.html">linalg_inv()</a></code> computes the inverse of a square matrix.</p></li>
<li><p><code><a href="linalg_lstsq.html">linalg_lstsq()</a></code> computes <code>A$pinv() %*% B</code> with a
numerically stable algorithm.</p></li>
</ul><p>Other linalg:
<code><a href="linalg_cholesky.html">linalg_cholesky()</a></code>,
<code><a href="linalg_cholesky_ex.html">linalg_cholesky_ex()</a></code>,
<code><a href="linalg_det.html">linalg_det()</a></code>,
<code><a href="linalg_eig.html">linalg_eig()</a></code>,
<code><a href="linalg_eigh.html">linalg_eigh()</a></code>,
<code><a href="linalg_eigvals.html">linalg_eigvals()</a></code>,
<code><a href="linalg_eigvalsh.html">linalg_eigvalsh()</a></code>,
<code><a href="linalg_householder_product.html">linalg_householder_product()</a></code>,
<code><a href="linalg_inv.html">linalg_inv()</a></code>,
<code><a href="linalg_inv_ex.html">linalg_inv_ex()</a></code>,
<code><a href="linalg_lstsq.html">linalg_lstsq()</a></code>,
<code><a href="linalg_matrix_norm.html">linalg_matrix_norm()</a></code>,
<code><a href="linalg_matrix_power.html">linalg_matrix_power()</a></code>,
<code><a href="linalg_matrix_rank.html">linalg_matrix_rank()</a></code>,
<code><a href="linalg_multi_dot.html">linalg_multi_dot()</a></code>,
<code><a href="linalg_norm.html">linalg_norm()</a></code>,
<code><a href="linalg_qr.html">linalg_qr()</a></code>,
<code><a href="linalg_slogdet.html">linalg_slogdet()</a></code>,
<code><a href="linalg_solve.html">linalg_solve()</a></code>,
<code><a href="linalg_solve_triangular.html">linalg_solve_triangular()</a></code>,
<code><a href="linalg_svd.html">linalg_svd()</a></code>,
<code><a href="linalg_svdvals.html">linalg_svdvals()</a></code>,
<code><a href="linalg_tensorinv.html">linalg_tensorinv()</a></code>,
<code><a href="linalg_tensorsolve.html">linalg_tensorsolve()</a></code>,
<code><a href="linalg_vector_norm.html">linalg_vector_norm()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="torch_is_installed.html">torch_is_installed</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="torch_randn.html">torch_randn</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">linalg_pinv</span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> torch_tensor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0517 -0.4091 -0.1494</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.5276  0.3803 -0.2363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.0258  0.2677  0.2618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.5259  0.3422 -0.0605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.2356 -0.3627  0.1077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ CPUFloatType{5,3} ]</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Falbel, Javier Luraschi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

